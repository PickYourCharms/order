<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Build My Bracelet</title>

<style>
/* =========================
   GLOBAL RESET
========================= */
* {
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  user-select: none;
}

img {
  pointer-events: none;
}

/* =========================
   BASE
========================= */
body {
  margin: 0;
  padding: 16px;
  font-family: system-ui, -apple-system, sans-serif;
  background: #f9f7f4;
  text-align: center;
  color: #111;
}

h2 {
  margin: 8px 0 12px;
}

/* =========================
   HEADER
========================= */
.header {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.back {
  font-size: 14px;
  cursor: pointer;
}

/* =========================
   METAL TOGGLE
========================= */
.metal-toggle {
  display: inline-flex;
  gap: 6px;
  margin: 12px 0;
}

.metal-toggle button {
  padding: 6px 14px;
  border-radius: 999px;
  border: 1px solid #ccc;
  background: #fff;
  cursor: pointer;
}

.metal-toggle button.active {
  background: #000;
  color: #fff;
  border-color: #000;
}

/* =========================
   CANVAS
========================= */
.canvas-wrap {
  position: relative;
  margin-top: 8px;
}

.canvas {
  position: relative;
  width: min(92vw, 360px);
  aspect-ratio: 1 / 1;
  margin: 0 auto;
}

.bracelet {
  position: absolute;
  width: 72%;
  height: 72%;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
}

/* =========================
   PRICE PILL
========================= */
.price-pill {
  position: absolute;
  top: 10px;
  right: 10px;
  padding: 6px 12px;
  border-radius: 999px;
  background: rgba(255,255,255,0.7);
  backdrop-filter: blur(10px);
  font-size: 14px;
}

/* =========================
   CHARMS
========================= */
.charm {
  position: absolute;
  cursor: pointer;
  transform-origin: top center;
}

.charm img {
  display: block;
}

/* =========================
   HINT
========================= */
.hint {
  margin-top: 8px;
  font-size: 13px;
  color: #666;
}

/* =========================
   TRAY
========================= */
.tray {
  margin-top: 14px;
  padding: 14px;
  background: #fff;
  border-radius: 16px;
  display: flex;
  justify-content: center;
  gap: 16px;
}

/* =========================
   RESET
========================= */
.reset-row {
  display: flex;
  justify-content: flex-end;
  margin-top: 6px;
}

.reset-row button {
  background: none;
  border: none;
  color: #666;
  cursor: pointer;
}

/* =========================
   CTA
========================= */
.cta {
  margin-top: 14px;
}

.cta button {
  width: 100%;
  padding: 14px;
  border-radius: 999px;
  border: none;
  background: #000;
  color: #fff;
  font-size: 16px;
  display: none;
}

/* =========================
   MODAL
========================= */
.modal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.35);
  display: flex;
  align-items: center;
  justify-content: center;
}

.modal.hidden {
  display: none;
}

.modal-card {
  background: #fff;
  border-radius: 16px;
  padding: 20px;
  width: 80%;
  max-width: 300px;
}

.modal-actions {
  display: flex;
  gap: 10px;
  margin-top: 16px;
}

.modal-actions button {
  flex: 1;
  padding: 10px;
  border-radius: 999px;
  border: none;
  cursor: pointer;
}

.confirm {
  background: #000;
  color: #fff;
}

/* =========================
   PREMIUM TOAST
========================= */
.toast {
  position: fixed;
  bottom: 20%;
  left: 50%;
  transform: translateX(-50%);
  background: #000;
  color: #fff;
  padding: 8px 14px;
  border-radius: 999px;
  font-size: 13px;
  opacity: 0;
  transition: opacity 0.3s;
}

.toast.show {
  opacity: 1;
}
</style>
</head>

<body>

<div class="header">
  <div class="back">‚Üê Back</div>
  <div></div>
</div>

<h2>Build My Bracelet</h2>

<div class="metal-toggle">
  <button id="goldBtn" class="active">Gold</button>
  <button id="silverBtn">Silver</button>
</div>

<div class="canvas-wrap">
  <div class="canvas" id="canvas">
    <div class="price-pill" id="pricePill">Rs. 399</div>
    <img id="braceletImg" class="bracelet" src="assets/bases/bracelet_base_gold.png" />
  </div>
</div>

<div class="hint">Tap a charm to add ‚Ä¢ Tap charm to remove</div>

<div class="tray" id="tray"></div>

<div class="reset-row">
  <button id="resetBtn">Reset</button>
</div>

<div class="cta">
  <button id="ctaBtn">Love it ¬∑ Add to Bag üõçÔ∏è</button>
</div>

<!-- MODAL -->
<div id="modal" class="modal hidden">
  <div class="modal-card">
    <p id="modalText"></p>
    <div class="modal-actions">
      <button id="cancelModal">Cancel</button>
      <button id="confirmModal" class="confirm">Confirm</button>
    </div>
  </div>
</div>

<div class="toast" id="toast">Premium charm added ‚ú®</div>

<script>
/* =========================
   CONFIG (LOCKED)
========================= */
const CHARM_PHYSICS = {
  size: 46,
  anchorX: 23,
  anchorY: 6,
  scale: 0.9,
  attachOffset: 2
};

const SLOT_ANGLES = {
  1: [90],
  2: [70,110],
  3: [60,90,120],
  4: [45,75,105,135],
  5: [40,65,90,115,140]
};

const PRICING = {
  base: 399,
  charm: 60,
  premium: 99
};

const GOLD_CHARMS = [
  "3DBowRibbon_Charm_Gold.png",
  "EvilEye_Charm_Gold.png",
  "LetterA_Charm_Gold.png",
  "NorthStar_Charm_Gold.png",
  "RedCherry_Charm_Gold.png"
];

const SILVER_CHARMS = [
  "3DBowRibbon_Charm_Silver.png",
  "EvilEye_Charm_Silver.png",
  "LetterA_Charm_Silver.png",
  "NorthStar_Charm_Silver.png",
  "RedCherry_Charm_Silver.png"
];

const PREMIUM_CHARMS = [
  "NorthStar"
];

/* =========================
   STATE
========================= */
let metal = "gold";
let charms = [];

const canvas = document.getElementById("canvas");
const tray = document.getElementById("tray");
const braceletImg = document.getElementById("braceletImg");
const pricePill = document.getElementById("pricePill");
const ctaBtn = document.getElementById("ctaBtn");

/* =========================
   MODAL
========================= */
const modal = document.getElementById("modal");
const modalText = document.getElementById("modalText");
const confirmModal = document.getElementById("confirmModal");
const cancelModal = document.getElementById("cancelModal");

let modalAction = null;

function openModal(text, action) {
  modalText.textContent = text;
  modalAction = action;
  modal.classList.remove("hidden");
}

confirmModal.onclick = () => {
  modal.classList.add("hidden");
  modalAction && modalAction();
};

cancelModal.onclick = () => modal.classList.add("hidden");

/* =========================
   TOAST
========================= */
const toast = document.getElementById("toast");
function showToast() {
  toast.classList.add("show");
  setTimeout(() => toast.classList.remove("show"), 1400);
}

/* =========================
   LOGIC
========================= */
function loadTray() {
  tray.innerHTML = "";
  const list = metal === "gold" ? GOLD_CHARMS : SILVER_CHARMS;
  list.forEach(name => {
    const img = document.createElement("img");
    img.src = `assets/charms/${name}`;
    img.style.width = "44px";
    img.onclick = () => addCharm(name);
    tray.appendChild(img);
  });
}

function addCharm(name) {
  if (charms.length >= 5) return;
  charms.push(name);
  if (PREMIUM_CHARMS.some(p => name.includes(p))) showToast();
  render();
}

function removeCharm(i) {
  charms.splice(i,1);
  render();
}

function calculatePrice() {
  let total = PRICING.base + charms.length * PRICING.charm;
  charms.forEach(c => {
    if (PREMIUM_CHARMS.some(p => c.includes(p))) {
      total += PRICING.premium;
    }
  });
  pricePill.textContent = `Rs. ${total}`;
}

function render() {
  document.querySelectorAll(".charm").forEach(e => e.remove());
  calculatePrice();

  ctaBtn.style.display = charms.length ? "block" : "none";
  if (!charms.length) return;

  const rect = canvas.getBoundingClientRect();
  const cx = rect.width / 2;
  const cy = rect.height / 2;
  const radius = rect.width * 0.36;
  const angles = SLOT_ANGLES[charms.length];

  charms.forEach((src,i) => {
    const angle = angles[angles.length - 1 - i];
    const rad = angle * Math.PI / 180;

    const x = cx + radius * Math.cos(rad);
    const y = cy + radius * Math.sin(rad) + CHARM_PHYSICS.attachOffset;

    const wrap = document.createElement("div");
    wrap.className = "charm";
    wrap.style.left = `${x - CHARM_PHYSICS.anchorX}px`;
    wrap.style.top = `${y - CHARM_PHYSICS.anchorY}px`;
    wrap.style.transform = `rotate(${angle - 90}deg) scale(${CHARM_PHYSICS.scale})`;

    const img = document.createElement("img");
    img.src = `assets/charms/${src}`;
    img.style.width = CHARM_PHYSICS.size + "px";

    wrap.appendChild(img);
    wrap.onclick = () => removeCharm(i);
    canvas.appendChild(wrap);
  });
}

/* =========================
   EVENTS
========================= */
document.getElementById("goldBtn").onclick = () => {
  if (metal === "gold") return;
  if (!charms.length) {
    metal = "gold";
    braceletImg.src = "assets/bases/bracelet_base_gold.png";
    loadTray();
    document.getElementById("goldBtn").classList.add("active");
    document.getElementById("silverBtn").classList.remove("active");
    return;
  }
  openModal("Switching metal will reset your design.", () => {
    charms = [];
    metal = "gold";
    braceletImg.src = "assets/bases/bracelet_base_gold.png";
    loadTray();
    document.getElementById("goldBtn").classList.add("active");
    document.getElementById("silverBtn").classList.remove("active");
    render();
  });
};

document.getElementById("silverBtn").onclick = () => {
  if (metal === "silver") return;
  if (!charms.length) {
    metal = "silver";
    braceletImg.src = "assets/bases/bracelet_base_silver.png";
    loadTray();
    document.getElementById("silverBtn").classList.add("active");
    document.getElementById("goldBtn").classList.remove("active");
    return;
  }
  openModal("Switching metal will reset your design.", () => {
    charms = [];
    metal = "silver";
    braceletImg.src = "assets/bases/bracelet_base_silver.png";
    loadTray();
    document.getElementById("silverBtn").classList.add("active");
    document.getElementById("goldBtn").classList.remove("active");
    render();
  });
};

document.getElementById("resetBtn").onclick = () => {
  if (!charms.length) return;
  openModal("Reset your bracelet?", () => {
    charms = [];
    render();
  });
};

loadTray();
</script>

</body>
</html>
