<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Build My Bracelet</title>

<style>
body {
  margin: 0;
  padding: 16px;
  font-family: system-ui, -apple-system, sans-serif;
  background: #fffaf3;
  text-align: center;
}

h2 { margin: 12px 0; }

img {
  -webkit-user-drag: none;
  user-select: none;
  -webkit-touch-callout: none;
}

.topbar {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.toggle {
  display: flex;
  gap: 8px;
  justify-content: center;
  margin: 12px 0;
}

.toggle button {
  padding: 8px 16px;
  border-radius: 999px;
  border: 1px solid #ddd;
  background: #fff;
  cursor: pointer;
}

.toggle .active {
  background: #000;
  color: #fff;
}

.canvas {
  position: relative;
  width: min(92vw, 360px);
  aspect-ratio: 1;
  margin: 0 auto;
}

.bracelet {
  position: absolute;
  width: 72%;
  height: 72%;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
}

.price-pill {
  position: absolute;
  top: 12px;
  right: 12px;
  background: rgba(255,255,255,0.75);
  backdrop-filter: blur(10px);
  padding: 6px 12px;
  border-radius: 999px;
  font-size: 14px;
}

.charm {
  position: absolute;
  transform-origin: top center;
  animation: pop 0.2s ease;
}

@keyframes pop {
  from { transform: scale(0.85); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}

.charm img {
  width: 46px;
}

.tray {
  background: #fff;
  border-radius: 16px;
  padding: 14px;
  margin-top: 16px;
  display: flex;
  gap: 16px;
  justify-content: center;
}

.tray img {
  width: 44px;
  cursor: pointer;
}

.hint {
  font-size: 13px;
  color: #777;
  margin-top: 8px;
}

.cta {
  margin-top: 16px;
  padding: 14px;
  border-radius: 14px;
  background: #000;
  color: #fff;
  display: none;
}
</style>
</head>

<body>

<div class="topbar">
  <span>‚Üê Back</span>
  <span id="resetBtn">Reset</span>
</div>

<h2>Build My Bracelet</h2>

<div class="toggle">
  <button id="goldBtn" class="active">Gold</button>
  <button id="silverBtn">Silver</button>
</div>

<div class="canvas" id="canvas">
  <img id="braceletBase" class="bracelet" src="assets/bases/bracelet_base_gold.png" />
  <div class="price-pill" id="pricePill">Rs. 399</div>
</div>

<div class="hint">Tap a charm to add ‚Ä¢ Tap charm to remove</div>

<div class="tray" id="tray"></div>

<div class="cta" id="ctaBtn">Love it ¬∑ Add to Bag üëú</div>

<script>
/* ---------------- CONFIG ---------------- */
const BASE_PRICE = 399;
const CHARM_PRICE = 60;
const PREMIUM_SURCHARGE = 99;

const GOLD_CHARMS = [
  "3DBowRibbon_Charm_Gold.png",
  "EvilEye_Charm_Gold.png",
  "LetterA_Charm_Gold.png",
  "NorthStar_Charm_Gold.png",
  "RedCherry_Charm_Gold.png"
];

const SILVER_CHARMS = [
  "3DBowRibbon_Charm_Silver.png",
  "EvilEye_Charm_Silver.png",
  "LetterA_Charm_Silver.png",
  "NorthStar_Charm_Silver.png",
  "RedCherry_Charm_Silver.png"
];

const PREMIUM_KEYS = ["LetterA", "NorthStar"];

const SLOT_ANGLES = {
  1: [90],
  2: [70,110],
  3: [60,90,120],
  4: [45,75,105,135],
  5: [40,65,90,115,140]
};

/* ---------------- STATE ---------------- */
let metal = "gold";
let charms = [];

const canvas = document.getElementById("canvas");
const tray = document.getElementById("tray");
const braceletBase = document.getElementById("braceletBase");
const pricePill = document.getElementById("pricePill");
const ctaBtn = document.getElementById("ctaBtn");

/* ---------------- FUNCTIONS ---------------- */
function renderTray() {
  tray.innerHTML = "";
  const list = metal === "gold" ? GOLD_CHARMS : SILVER_CHARMS;

  list.forEach(file => {
    const img = document.createElement("img");
    img.src = `assets/charms/${file}`;
    img.oncontextmenu = e => e.preventDefault();
    img.onclick = () => addCharm(file);
    tray.appendChild(img);
  });
}

function addCharm(file) {
  if (charms.length >= 5) return;
  charms.push(file);
  render();
}

function removeCharm(i) {
  charms.splice(i,1);
  render();
}

function calculatePrice() {
  let price = BASE_PRICE + charms.length * CHARM_PRICE;
  charms.forEach(c => {
    if (PREMIUM_KEYS.some(k => c.includes(k))) price += PREMIUM_SURCHARGE;
  });
  return price;
}

function render() {
  document.querySelectorAll(".charm").forEach(c => c.remove());
  pricePill.textContent = `Rs. ${calculatePrice()}`;
  ctaBtn.style.display = charms.length ? "block" : "none";

  if (!charms.length) return;

  const rect = canvas.getBoundingClientRect();
  const cx = rect.width/2, cy = rect.height/2;
  const radius = rect.width * 0.36;
  const angles = SLOT_ANGLES[charms.length];

  charms.forEach((file,i)=>{
    const angle = angles[angles.length-1-i];
    const rad = angle*Math.PI/180;
    const x = cx + radius*Math.cos(rad);
    const y = cy + radius*Math.sin(rad) + 2;

    const wrap = document.createElement("div");
    wrap.className = "charm";
    wrap.style.left = `${x-23}px`;
    wrap.style.top = `${y-6}px`;
    wrap.style.transform = `rotate(${angle-90}deg)`;

    const img = document.createElement("img");
    img.src = `assets/charms/${file}`;
    img.oncontextmenu = e => e.preventDefault();

    wrap.appendChild(img);
    wrap.onclick = ()=>removeCharm(i);
    canvas.appendChild(wrap);
  });
}

/* ---------------- METAL SWITCH ---------------- */
document.getElementById("goldBtn").onclick = () => switchMetal("gold");
document.getElementById("silverBtn").onclick = () => switchMetal("silver");

function switchMetal(m) {
  if (metal === m) return;
  if (charms.length && !confirm("Switch metal? This will reset your design.")) return;
  metal = m;
  charms = [];
  braceletBase.src = `assets/bases/bracelet_base_${m}.png`;
  document.getElementById("goldBtn").classList.toggle("active", m==="gold");
  document.getElementById("silverBtn").classList.toggle("active", m==="silver");
  renderTray();
  render();
}

/* ---------------- RESET ---------------- */
document.getElementById("resetBtn").onclick = () => {
  if (!charms.length) return;
  if (confirm("Reset your bracelet?")) {
    charms = [];
    render();
  }
};

renderTray();
render();
</script>

</body>
</html>
